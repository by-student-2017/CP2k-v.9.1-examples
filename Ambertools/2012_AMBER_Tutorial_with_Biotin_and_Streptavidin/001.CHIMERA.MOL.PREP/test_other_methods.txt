#---------------------------------------------------------------------
# 2012 AMBER Tutorial with Biotin and Streptavidin
# https://ringo.ams.stonybrook.edu/index.php/2012_AMBER_Tutorial_with_Biotin_and_Streptavidin
#---------------------------------------------------------------------
(conda activate AmberTools23)
#---------------------------------------------------------------------
# II. Structural Preparation
1. mkdir 001.CHIMERA.MOL.PREP
2. cd 001.CHIMERA.MOL.PREP
3. wget https://files.rcsb.org/download/1DF8.pdb
#---------------------------------------------------------------------
# Preparation in Chimera

# 1DF8.rec.lig.pdb:
1. chimera
2. File -> Open... -> 1DF8.pdb -> Open
3. Select -> Chain -> B
4. Actions -> Atoms/Bonds -> delete
5. Select -> Reside -> HOH
6. Actions -> Atoms/Bonds -> delete
7. File -> Save PDB... -> File name: 1DF8.rec.lig.pdb -> Save
8. File -> Quit

# 1DF8.rec.noH.pdb
1. chimera
2. File -> Open... -> 1DF8.pdb -> Open
3. Select -> Reside -> BTN
4. Actions -> Atoms/Bonds -> delete
5. File -> Save PDB... -> File name: 1DF8.rec.lig.pdb -> Save
6. File -> Quit

# 1DF8.lig.chimera.mol2
1. chimera
2. File -> Open... -> 1DF8.pdb -> Open
3. Select -> Reside -> BTN
4. Select -> Invert (all models)
5. Actions -> Atoms/Bonds -> delete
6. Tools -> Structure Editing -> Dock Prep -> (All) OK -> [1DF8.lig.chimera.mol2] Save
  (Other residues: AM1-BCC)
#---------------------------------------------------------------------
# antechamber
1. sed -e "s/H102/H17 /g" 1DF8.lig.chimera.mol2 > 1DF8.lig.mol2
2. sed -i "s/H103/H18 /g" 1DF8.lig.mol2
#---------------------------------------------------------------------
# LEaP
1. antechamber -i ../001.CHIMERA.MOL.PREP/1DF8.lig.mol2 -fi mol2 -o 1DF8.lig.ante.pdb -fo pdb
#---------------------------------------------------------------------
#---------------------------------------------------------------------
## USCF Chimera (Free for non-commercial use)
- http://www.cgl.ucsf.edu/chimera/
- Info: https://ringo.ams.stonybrook.edu/index.php/Chimera
1. Quick Links -> Download
2. Linux 64-bit -> chimera-1.18-linux_x86_64.bin -> Accept
```
chmod +x chimera-1.18-linux_x86_64.bin
./chimera-1.18-linux_x86_64.bin
echo 'export PATH=$PATH:$HOME/.local/UCSF-Chimera64-1.18/bin' >> ~/.bashrc
bash
which chimera
```
- Open chimera command
```
chimera
```
- Note: Chimera is often used in "AMBER Tutorials (https://ringo.ams.stonybrook.edu/index.php/AMBER_Tutorials)". Sometimes preprocessing with Openbabel or reduce (AmberTools) doesn't work well. Therefore, it is good to be able to use Chimera.

Ref: https://pdbj.org/cms-data/workshop/20210118_19/UCSFChimera_Install_Win_20210112.pdf (Japanese)
#---------------------------------------------------------------------